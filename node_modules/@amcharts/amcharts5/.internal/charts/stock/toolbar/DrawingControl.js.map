{"version":3,"file":"DrawingControl.js","sourceRoot":"","sources":["../../../../../../src/.internal/charts/stock/toolbar/DrawingControl.ts"],"names":[],"mappings":"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","sourcesContent":["import type { XYSeries } from \"../../xy/series/XYSeries\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport type { ColorSet } from \"../../../core/util/ColorSet\";\r\nimport type { IDropdownListItem } from \"./DropdownList\";\r\nimport type { StockPanel } from \"../StockPanel\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\n\r\nimport { color } from \"../../../core/util/Color\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DrawingToolControl, DrawingTools } from \"./DrawingToolControl\";\r\nimport { ColorControl } from \"./ColorControl\";\r\nimport { DropdownListControl } from \"./DropdownListControl\";\r\nimport { IconControl, IIcon } from \"./IconControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\nimport { DrawingSeries } from \"../drawing/DrawingSeries\";\r\n\r\nimport { AverageSeries } from \"../drawing/AverageSeries\";\r\nimport { CalloutSeries } from \"../drawing/CalloutSeries\";\r\nimport { EllipseSeries } from \"../drawing/EllipseSeries\";\r\nimport { DoodleSeries } from \"../drawing/DoodleSeries\";\r\nimport { FibonacciSeries } from \"../drawing/FibonacciSeries\";\r\nimport { FibonacciTimezoneSeries } from \"../drawing/FibonacciTimezoneSeries\";\r\nimport { HorizontalLineSeries } from \"../drawing/HorizontalLineSeries\";\r\nimport { HorizontalRaySeries } from \"../drawing/HorizontalRaySeries\";\r\nimport { IconSeries } from \"../drawing/IconSeries\";\r\nimport { LabelSeries } from \"../drawing/LabelSeries\";\r\nimport { SimpleLineSeries } from \"../drawing/SimpleLineSeries\";\r\nimport { LineArrowSeries } from \"../drawing/LineArrowSeries\";\r\nimport { PolylineSeries } from \"../drawing/PolylineSeries\";\r\nimport { QuadrantLineSeries } from \"../drawing/QuadrantLineSeries\";\r\nimport { RectangleSeries } from \"../drawing/RectangleSeries\";\r\nimport { ParallelChannelSeries } from \"../drawing/ParallelChannelSeries\";\r\nimport { RegressionSeries } from \"../drawing/RegressionSeries\";\r\nimport { TrendLineSeries } from \"../drawing/TrendLineSeries\";\r\nimport { VerticalLineSeries } from \"../drawing/VerticalLineSeries\";\r\nimport { Measure } from \"../drawing/Measure\";\r\nimport { JsonParser } from \"../../../plugins/json/Json\";\r\nimport { Serializer } from \"../../../plugins/json/Serializer\";\r\n\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $object from \"../../../core/util/Object\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDrawingControlSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * List of tools available in drawing mode.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Tool_list} for more info\r\n\t */\r\n\ttools?: DrawingTools[];\r\n\r\n\t/**\r\n\t * Default tool.\r\n\t */\r\n\ttool?: DrawingTools,\r\n\r\n\t/**\r\n\t * If set to `true`, the dropdown will fix the height to fit within chart's\r\n\t * area, with scroll if the contents do not fit.\r\n\t *\r\n\t * @since 5.9.5\r\n\t */\r\n\tscrollable?: boolean;\r\n\r\n\t/**\r\n\t * Default settings for drawing tools.\r\n\t *\r\n\t * @since 5.5.2\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Tool_settings} for more info\r\n\t */\r\n\ttoolSettings?: { [index: string]: any };\r\n\r\n\t/**\r\n\t * Target series for drawing.\r\n\t */\r\n\tseries?: XYSeries[];\r\n\r\n\t/**\r\n\t * Colors to show in color pickers.\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Colors} for more info\r\n\t */\r\n\tcolors?: ColorSet;\r\n\r\n\t/**\r\n\t * Default color for lines/borders.\r\n\t */\r\n\tstrokeColor?: Color;\r\n\r\n\t/**\r\n\t * Default line/border width in pixels.\r\n\t */\r\n\tstrokeWidth?: number;\r\n\r\n\t/**\r\n\t * Available line widths for user to choose from.\r\n\t */\r\n\tstrokeWidths?: number[];\r\n\r\n\t/**\r\n\t * Default dasharray setting.\r\n\t */\r\n\tstrokeDasharray?: number[];\r\n\r\n\t/**\r\n\t * Available line dash settings for user to choose from.\r\n\t */\r\n\tstrokeDasharrays?: number[][];\r\n\r\n\t/**\r\n\t * Default line/border opacity.\r\n\t */\r\n\tstrokeOpacity?: number;\r\n\r\n\t/**\r\n\t * Show dotted/thin line extending from both ends of the drawn line?\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tshowExtension?: boolean;\r\n\r\n\t/**\r\n\t * Default fill color.\r\n\t */\r\n\tfillColor?: Color;\r\n\r\n\t/**\r\n\t * Default fill opacity.\r\n\t */\r\n\tfillOpacity?: number;\r\n\r\n\t/**\r\n\t * Default color for labels.\r\n\t */\r\n\tlabelFill?: Color;\r\n\r\n\t/**\r\n\t * Default label font size.\r\n\t */\r\n\tlabelFontSize?: number | string | undefined;\r\n\r\n\t/**\r\n\t * Available font sizes.\r\n\t */\r\n\tlabelFontSizes?: Array<number | string>;\r\n\r\n\t/**\r\n\t * Default label font.\r\n\t */\r\n\tlabelFontFamily?: string;\r\n\r\n\t/**\r\n\t * Available fonts for user to choose from.\r\n\t */\r\n\tlabelFontFamilies?: string[];\r\n\r\n\t/**\r\n\t * Default label font weight.\r\n\t */\r\n\tlabelFontWeight?: \"normal\" | \"bold\" | \"bolder\" | \"lighter\" | \"100\" | \"200\" | \"300\" | \"400\" | \"500\" | \"600\" | \"700\" | \"800\" | \"900\";\r\n\r\n\t/**\r\n\t * Default label style.\r\n\t */\r\n\tlabelFontStyle?: \"normal\" | \"italic\" | \"oblique\";\r\n\r\n\tdrawingIcon?: IIcon;\r\n\tdrawingIcons?: IIcon[];\r\n\r\n\t/**\r\n\t * Should drawings snap to the nearest data point?\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tsnapToData?: boolean;\r\n\r\n}\r\n\r\n\r\nexport interface IDrawingControlPrivate extends IStockControlPrivate {\r\n\ttoolsContainer?: HTMLDivElement;\r\n\t// icon?: HTMLElement;\r\n\t// label?: HTMLDivElement;\r\n\ttoolControl?: DrawingToolControl;\r\n\teraserControl?: StockControl;\r\n\r\n\t/**\r\n\t * Selector mode toggler.\r\n\t *\r\n\t * @since 5.9.1\r\n\t */\r\n\tselectControl?: StockControl;\r\n\tclearControl?: StockControl;\r\n\r\n\tstrokeControl?: ColorControl;\r\n\tstrokeWidthControl?: DropdownListControl;\r\n\tstrokeDasharrayControl?: DropdownListControl;\r\n\tfillControl?: ColorControl;\r\n\textensionControl?: StockControl;\r\n\r\n\tlabelFillControl?: ColorControl;\r\n\tlabelFontSizeControl?: DropdownListControl;\r\n\tlabelFontFamilyControl?: DropdownListControl;\r\n\tboldControl?: StockControl;\r\n\titalicControl?: StockControl;\r\n\r\n\ticonControl?: IconControl;\r\n\tsnapControl?: StockControl;\r\n\r\n\ttoolTemplates?: { [index: string]: Template<any> };\r\n}\r\n\r\nexport interface IDrawingControlEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * A drawing tools control for [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/} for more info\r\n */\r\nexport class DrawingControl extends StockControl {\r\n\tpublic static className: string = \"DrawingControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DrawingControl.className]);\r\n\r\n\tdeclare public _settings: IDrawingControlSettings;\r\n\tdeclare public _privateSettings: IDrawingControlPrivate;\r\n\tdeclare public _events: IDrawingControlEvents;\r\n\r\n\tprivate _drawingSeries: { [index: string]: DrawingSeries[] } = {};\r\n\tprivate _currentEnabledSeries: DrawingSeries[] = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Init drawing toolbar\r\n\t\tif (this.getPrivate(\"toolbar\")) {\r\n\t\t\tthis._initToolbar();\r\n\t\t}\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.events.onAll(() => this._updatePanelBindings());\r\n\r\n\t\tstockChart.events.on(\"drawingselected\", (ev) => {\r\n\t\t\t// Set tool\r\n\t\t\tconst tool = this._getSeriesTool(ev.series);\r\n\t\t\tthis.set(\"tool\", tool);\r\n\r\n\t\t\tif (!this._isInited()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Get context\r\n\t\t\tconst context = ev.series.getContext(ev.drawingId);\r\n\r\n\t\t\tif (tool == \"Label\" || tool == \"Callout\") {\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t * Labels and callouts\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t */\r\n\r\n\t\t\t\t// Set fill\r\n\t\t\t\tconst settings = context.settings;\r\n\t\t\t\tif (settings) {\r\n\t\t\t\t\tthis.getPrivate(\"labelFillControl\")!.setColor(settings.get(\"fill\"));\r\n\t\t\t\t\tthis.getPrivate(\"labelFontSizeControl\")!.setItemById(settings.get(\"fontSize\"));\r\n\t\t\t\t\tthis.getPrivate(\"boldControl\")!.set(\"active\", settings.get(\"fontWeight\") == \"bold\");\r\n\t\t\t\t\tthis.getPrivate(\"italicControl\")!.set(\"active\", settings.get(\"fontStyle\") == \"italic\");\r\n\t\t\t\t\tthis.getPrivate(\"labelFontFamilyControl\")!.setItemById(settings.get(\"fontFamily\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Callout background/outline\r\n\t\t\t\tconst bg = context.bgSettings;\r\n\t\t\t\tif (bg) {\r\n\t\t\t\t\tconst strokeControl = this.getPrivate(\"strokeControl\")!;\r\n\t\t\t\t\tstrokeControl.setColor(bg.get(\"stroke\"));\r\n\t\t\t\t\tstrokeControl.setOpacity(bg.get(\"strokeOpacity\"));\r\n\r\n\t\t\t\t\tconst fillControl = this.getPrivate(\"fillControl\")!;\r\n\t\t\t\t\tfillControl.setColor(bg.get(\"fill\"));\r\n\t\t\t\t\tfillControl.setOpacity(bg.get(\"fillOpacity\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t * The rest of the stuff\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t */\r\n\r\n\t\t\t\t// Set stroke\r\n\t\t\t\tconst stroke = context.stroke || context.settings;\r\n\t\t\t\tif (stroke) {\r\n\t\t\t\t\tconst strokeControl = this.getPrivate(\"strokeControl\")!;\r\n\t\t\t\t\tstrokeControl.setColor(stroke.get(\"stroke\"));\r\n\t\t\t\t\tstrokeControl.setOpacity(stroke.get(\"strokeOpacity\"));\r\n\t\t\t\t\tthis.getPrivate(\"strokeWidthControl\")!.setItemById(stroke.get(\"strokeWidth\") + \"px\");\r\n\t\t\t\t\tthis.getPrivate(\"strokeDasharrayControl\")!.setItemById(JSON.stringify(stroke.get(\"strokeDasharray\")));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Set fill\r\n\t\t\t\tconst fill = context.fill || context.settings;\r\n\t\t\t\tif (fill) {\r\n\t\t\t\t\tconst fillControl = this.getPrivate(\"fillControl\")!;\r\n\t\t\t\t\tfillControl.setColor(fill.get(\"fill\"));\r\n\t\t\t\t\tfillControl.setOpacity(fill.get(\"fillOpacity\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Handle icons\r\n\t\t\t\tconst sprite = context.settings || context.sprite;\r\n\t\t\t\tif (sprite && sprite.get(\"svgPath\")) {\r\n\t\t\t\t\tthis.getPrivate(\"iconControl\")!.setIconByPath(sprite.get(\"svgPath\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\t}\r\n\r\n\tprotected _isInited(): boolean {\r\n\t\treturn this.getPrivate(\"toolsContainer\") ? true : false;\r\n\t}\r\n\r\n\tprotected _resetControls(): void {\r\n\t\tthis.getPrivate(\"eraserControl\")!.set(\"active\", false);\r\n\t}\r\n\r\n\tprotected _initToolbar(): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst l = this._root.language;\r\n\r\n\t\t// Add additional container for drawing toolbar\r\n\t\tconst toolbar = this.getPrivate(\"toolbar\")!;\r\n\t\tconst toolsContainer = document.createElement(\"div\");\r\n\t\ttoolsContainer.className = \"am5stock-control-drawing-tools\";\r\n\t\ttoolsContainer.style.display = \"none\";\r\n\t\tthis.setPrivate(\"toolsContainer\", toolsContainer);\r\n\t\ttoolbar.get(\"container\").appendChild(toolsContainer);\r\n\r\n\t\t/**\r\n\t\t * Drawing tool selection control\r\n\t\t */\r\n\t\tconst toolControl = DrawingToolControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Drawing tool\"),\r\n\t\t\ttools: this.get(\"tools\")!,\r\n\t\t\tscrollable: this.get(\"scrollable\", false)\r\n\t\t});\r\n\r\n\t\ttoolControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\ttoolsContainer.appendChild(toolControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"toolControl\", toolControl);\r\n\r\n\t\ttoolControl.events.on(\"selected\", (ev) => {\r\n\t\t\teraserControl.set(\"active\", false);\r\n\t\t\tthis.set(\"tool\", ev.tool);\r\n\t\t});\r\n\r\n\t\ttoolControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Icon selection control\r\n\t\t */\r\n\t\tconst drawingIcons = this.get(\"drawingIcons\")!;\r\n\t\tconst iconControl = IconControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Arrows &amp; Icons\"),\r\n\t\t\ticons: drawingIcons\r\n\t\t});\r\n\r\n\t\ticonControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\ticonControl.setIcon(this.get(\"drawingIcon\", drawingIcons[0]));\r\n\t\ttoolsContainer.appendChild(iconControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"iconControl\", iconControl);\r\n\r\n\t\ticonControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"drawingIcon\", ev.icon);\r\n\t\t});\r\n\r\n\t\ticonControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Snap toggle control\r\n\t\t */\r\n\t\tconst snapControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Snap icon to data\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Snap\")\r\n\t\t});\r\n\r\n\t\tsnapControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tsnapControl.hide();\r\n\t\ttoolsContainer.appendChild(snapControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"snapControl\", snapControl);\r\n\t\tif (this.get(\"snapToData\")) {\r\n\t\t\tsnapControl.set(\"active\", true);\r\n\t\t}\r\n\t\tsnapControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"snapToData\", snapControl.get(\"active\") == true);\r\n\t\t});\r\n\r\n\t\tsnapControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Stroke color control\r\n\t\t */\r\n\t\tconst strokeControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tdescription: l.translateAny(\"Line color\")\r\n\t\t});\r\n\r\n\t\tstrokeControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tstrokeControl.hide();\r\n\t\tstrokeControl.setPrivate(\"color\", this.get(\"strokeColor\", color(0x000000)));\r\n\t\tstrokeControl.setPrivate(\"opacity\", this.get(\"strokeOpacity\", 1));\r\n\t\ttoolsContainer.appendChild(strokeControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeControl\", strokeControl);\r\n\t\tstrokeControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeColor\", ev.color);\r\n\t\t});\r\n\t\tstrokeControl.events.on(\"selectedOpacity\", (ev) => {\r\n\t\t\tthis.set(\"strokeOpacity\", ev.opacity);\r\n\t\t});\r\n\r\n\t\tstrokeControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Stroke width control\r\n\t\t */\r\n\t\tconst strokeWidths: string[] = [];\r\n\t\t$array.each(this.get(\"strokeWidths\", []), (width) => {\r\n\t\t\tstrokeWidths.push(width + \"px\");\r\n\t\t});\r\n\t\tconst strokeWidthControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Line thickness\"),\r\n\t\t\tcurrentItem: this.get(\"strokeWidth\", \"12\") + \"px\",\r\n\t\t\titems: strokeWidths\r\n\t\t});\r\n\r\n\t\tstrokeWidthControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tstrokeWidthControl.hide();\r\n\t\t//strokeWidthControl.setItem(this.get(\"strokeWidth\", \"12\") + \"px\");\r\n\t\tstrokeWidthControl.getPrivate(\"icon\")!.style.display = \"none\";\r\n\t\ttoolsContainer.appendChild(strokeWidthControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeWidthControl\", strokeWidthControl);\r\n\t\tstrokeWidthControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeWidth\", $type.toNumber($type.isString(ev.item) ? ev.item : ev.item.id));\r\n\t\t});\r\n\r\n\t\tstrokeWidthControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Stroke dash cofiguration control\r\n\t\t */\r\n\t\tconst strokeDasharrays: IDropdownListItem[] = [];\r\n\t\tlet currentStrokeDasharray: SVGElement | undefined;\r\n\t\tconst strokeDasharray = this.get(\"strokeDasharray\", undefined);\r\n\t\t$array.each(this.get(\"strokeDasharrays\", []), (dasharray) => {\r\n\t\t\tconst icon = StockIcons.getIcon(\"Dash\");\r\n\t\t\tconst id = JSON.stringify(dasharray);\r\n\t\t\ticon.setAttribute(\"stroke\", \"#000\");\r\n\t\t\ticon.setAttribute(\"stroke-dasharray\", dasharray.join(\",\"));\r\n\t\t\ticon.setAttribute(\"class\", \"am5stock-icon-wide\");\r\n\t\t\tstrokeDasharrays.push({\r\n\t\t\t\tid: id,\r\n\t\t\t\tlabel: \"\",\r\n\t\t\t\ticon: icon\r\n\t\t\t});\r\n\r\n\t\t\tif (id == JSON.stringify(strokeDasharray)) {\r\n\t\t\t\tcurrentStrokeDasharray = StockIcons.getIcon(\"Dash\");\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"stroke\", \"#000\");\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"stroke-dasharray\", dasharray.join(\",\"));\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"class\", \"am5stock-icon-wide\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst strokeDasharrayControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Line style\"),\r\n\t\t\titems: strokeDasharrays\r\n\t\t});\r\n\r\n\t\tstrokeDasharrayControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tstrokeDasharrayControl.hide();\r\n\t\tif (currentStrokeDasharray) {\r\n\t\t\tstrokeDasharrayControl.setItem({\r\n\t\t\t\tid: \"\",\r\n\t\t\t\ticon: currentStrokeDasharray,\r\n\t\t\t\tlabel: \"\"\r\n\t\t\t});\r\n\t\t}\r\n\t\tstrokeDasharrayControl.getPrivate(\"icon\")!.setAttribute(\"class\", \"am5stock-control-icon am5stock-icon-wide\")\r\n\t\ttoolsContainer.appendChild(strokeDasharrayControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeDasharrayControl\", strokeDasharrayControl);\r\n\t\tstrokeDasharrayControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeDasharray\", JSON.parse((<IDropdownListItem>ev.item).id));\r\n\t\t});\r\n\r\n\t\tstrokeDasharrayControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Fill color control\r\n\t\t */\r\n\t\tconst fillControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tname: l.translateAny(\"Fill\"),\r\n\t\t\tdescription: l.translateAny(\"Fill color\"),\r\n\t\t});\r\n\t\tfillControl.hide();\r\n\t\tfillControl.setPrivate(\"toolbar\", toolbar);\r\n\t\tfillControl.setPrivate(\"color\", this.get(\"fillColor\", color(0x000000)));\r\n\t\tfillControl.setPrivate(\"opacity\", this.get(\"fillOpacity\", 1));\r\n\t\ttoolsContainer.appendChild(fillControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"fillControl\", fillControl);\r\n\t\tfillControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"fillColor\", ev.color);\r\n\t\t});\r\n\t\tfillControl.events.on(\"selectedOpacity\", (ev) => {\r\n\t\t\tthis.set(\"fillOpacity\", ev.opacity);\r\n\t\t});\r\n\r\n\t\tfillControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Label color control\r\n\t\t */\r\n\t\tconst labelFillControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tname: l.translateAny(\"Text\"),\r\n\t\t\tdescription: l.translateAny(\"Text color\"),\r\n\t\t\tuseOpacity: false\r\n\t\t});\r\n\t\tlabelFillControl.hide();\r\n\t\tlabelFillControl.setPrivate(\"toolbar\", toolbar);\r\n\t\tlabelFillControl.setPrivate(\"color\", this.get(\"labelFill\", color(0x000000)));\r\n\t\ttoolsContainer.appendChild(labelFillControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFillControl\", labelFillControl);\r\n\t\tlabelFillControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFill\", ev.color);\r\n\t\t});\r\n\r\n\t\tlabelFillControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Font size control\r\n\t\t */\r\n\t\tconst fontSizes: string[] = [];\r\n\t\t$array.each(this.get(\"labelFontSizes\", []), (size) => {\r\n\t\t\tfontSizes.push(size + \"\");\r\n\t\t});\r\n\t\tconst fontSizeControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Label font size\"),\r\n\t\t\tcurrentItem: this.get(\"labelFontSize\", \"12px\") + \"\",\r\n\t\t\titems: fontSizes,\r\n\t\t\ticon: \"none\"\r\n\t\t});\r\n\t\tfontSizeControl.hide();\r\n\t\tfontSizeControl.setPrivate(\"toolbar\", toolbar);\r\n\t\t//fontSizeControl.setItem(this.get(\"labelFontSize\", \"12px\") + \"\");\r\n\t\ttoolsContainer.appendChild(fontSizeControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFontSizeControl\", fontSizeControl);\r\n\t\tfontSizeControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFontSize\", $type.isString(ev.item) ? ev.item : ev.item.id);\r\n\t\t});\r\n\r\n\t\tfontSizeControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Bold control\r\n\t\t */\r\n\t\tconst boldControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Bold\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Bold\")\r\n\t\t});\r\n\t\tboldControl.hide();\r\n\t\tboldControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(boldControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"boldControl\", boldControl);\r\n\t\tboldControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"labelFontWeight\", boldControl.get(\"active\") ? \"bold\" : \"normal\");\r\n\t\t});\r\n\r\n\t\tboldControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Italic control\r\n\t\t */\r\n\t\tconst italicControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Italic\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Italic\")\r\n\t\t});\r\n\t\titalicControl.hide();\r\n\t\titalicControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(italicControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"italicControl\", italicControl);\r\n\t\titalicControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"labelFontStyle\", italicControl.get(\"active\") ? \"italic\" : \"normal\");\r\n\t\t});\r\n\r\n\t\titalicControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Font family control\r\n\t\t */\r\n\t\tconst fontFamilies: string[] = [];\r\n\t\t$array.each(this.get(\"labelFontFamilies\", []), (size) => {\r\n\t\t\tfontFamilies.push(size + \"\");\r\n\t\t});\r\n\t\tconst fontFamilyControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Label font family\"),\r\n\t\t\tcurrentItem: this.get(\"labelFontFamily\", \"Arial\"),\r\n\t\t\titems: fontFamilies,\r\n\t\t\ticon: \"none\"\r\n\t\t});\r\n\t\tfontFamilyControl.hide();\r\n\t\tfontFamilyControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(fontFamilyControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFontFamilyControl\", fontFamilyControl);\r\n\t\tfontFamilyControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFontFamily\", $type.isString(ev.item) ? ev.item : ev.item.id);\r\n\t\t});\r\n\r\n\t\tfontFamilyControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Line extension control\r\n\t\t */\r\n\t\tconst extensionControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Show line extension\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Show Extension\")\r\n\t\t});\r\n\t\textensionControl.hide();\r\n\t\textensionControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(extensionControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"extensionControl\", extensionControl);\r\n\t\tif (this.get(\"showExtension\")) {\r\n\t\t\textensionControl.set(\"active\", true);\r\n\t\t}\r\n\t\textensionControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"showExtension\", extensionControl.get(\"active\") == true);\r\n\t\t});\r\n\r\n\t\textensionControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Select control\r\n\t\t */\r\n\t\tconst selectControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Select\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Select\"),\r\n\t\t\tactive: stockChart.get(\"drawingSelectionEnabled\", stockChart.getPrivate(\"drawingSelectionEnabled\", false)),\r\n\t\t});\r\n\t\tthis._disposers.push(stockChart.on(\"drawingSelectionEnabled\", (active) => {\r\n\t\t\tselectControl.set(\"active\", active);\r\n\t\t}));\r\n\t\tthis._disposers.push(stockChart.onPrivate(\"drawingSelectionEnabled\", (active) => {\r\n\t\t\tselectControl.set(\"active\", active);\r\n\t\t}));\t\t\r\n\r\n\t\tselectControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(selectControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"selectControl\", selectControl);\r\n\t\tselectControl.on(\"active\", (_ev) => {\r\n\t\t\tconst active = selectControl.get(\"active\", false);\r\n\t\t\tstockChart.setPrivateRaw(\"drawingSelectionEnabled\", active);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Eraser control\r\n\t\t */\r\n\t\tconst eraserControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Eraser\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Eraser\")\r\n\t\t});\r\n\r\n\t\tthis._disposers.push(stockChart.on(\"erasingEnabled\", (active) => {\r\n\t\t\teraserControl.set(\"active\", active);\r\n\t\t}));\r\n\r\n\t\teraserControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(eraserControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"eraserControl\", eraserControl);\r\n\t\teraserControl.on(\"active\", (_ev) => {\r\n\t\t\tconst active = eraserControl.get(\"active\", false);\r\n\t\t\tthis.setEraser(active);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Clear all drawings control\r\n\t\t */\r\n\t\tconst clearControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tname: l.translateAny(\"Clear\"),\r\n\t\t\tdescription: l.translateAny(\"Clear all drawings\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Clear\"),\r\n\t\t\ttogglable: false\r\n\t\t});\r\n\t\tclearControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(clearControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"clearControl\", clearControl);\r\n\t\tthis._disposers.push($utils.addEventListener(clearControl.getPrivate(\"button\")!, \"click\", (_ev) => {\r\n\t\t\teraserControl.set(\"active\", false);\r\n\t\t\tthis.clearDrawings();\r\n\t\t}));\r\n\r\n\t\t// Preset active tool\r\n\t\tif (this.get(\"active\")) {\r\n\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables eraser mode.\r\n\t *\r\n\t * @since 5.3.9\r\n\t * @param  active  Eraser active\r\n\t */\r\n\tpublic setEraser(active: boolean) {\r\n\t\tthis.get(\"stockChart\").set(\"erasingEnabled\", active);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears all drawings.\r\n\t *\r\n\t * @since 5.3.9\r\n\t */\r\n\tpublic clearDrawings() {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\t//series.disableErasing();\r\n\t\t\t\tseries.clearDrawings();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t\tconst isInited = this._isInited();\r\n\r\n\t\tif (this.isDirty(\"tools\")) {\r\n\t\t\tconst toolControl = this.getPrivate(\"toolControl\");\r\n\t\t\tif (toolControl) {\r\n\t\t\t\ttoolControl.set(\"tools\", this.get(\"tools\")!);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isPrivateDirty(\"toolbar\")) {\r\n\t\t\tif (this.getPrivate(\"toolbar\")) {\r\n\t\t\t\tthis._initToolbar();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"active\")) {\r\n\t\t\tthis.get(\"stockChart\").toggleDrawing(this.get(\"active\"))\r\n\t\t\t\r\n\t\t\tif (this.get(\"active\")) {\t\t\t\t\r\n\t\t\t\tif (isInited) {\r\n\t\t\t\t\tthis.getPrivate(\"toolsContainer\")!.style.display = \"block\";\r\n\t\t\t\t}\r\n\t\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t\t\tif (isInited) {\r\n\t\t\t\t\t$utils.focus(this.getPrivate(\"toolControl\")!.getPrivate(\"button\") as HTMLElement);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (isInited) {\r\n\t\t\t\t\tthis.getPrivate(\"toolsContainer\")!.style.display = \"none\";\r\n\t\t\t\t}\r\n\t\t\t\tif(this.get(\"tool\")) {\r\n\t\t\t\t\tthis._setTool();\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\r\n\r\n\t\tif (this.isDirty(\"tool\") && this.get(\"active\")) {\r\n\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t}\r\n\r\n\t\tconst rootEvents = this._root.events;\r\n\t\tif (this.isDirty(\"strokeColor\") || this.isDirty(\"strokeWidth\") || this.isDirty(\"strokeOpacity\") || this.isDirty(\"strokeDasharray\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setStroke();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"fillColor\") || this.isDirty(\"fillOpacity\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setFill();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"labelFill\") || this.isDirty(\"labelFontSize\") || this.isDirty(\"labelFontFamily\") || this.isDirty(\"labelFontWeight\") || this.isDirty(\"labelFontStyle\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setLabel();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"showExtension\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setExtension();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"drawingIcon\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setDrawingIcon();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"snapToData\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setSnap();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _setTool(tool?: DrawingTools): void {\r\n\t\tconst isInited = this._isInited();\r\n\r\n\t\t// Disable current drawing series\r\n\t\t$array.each(this._currentEnabledSeries, (series) => {\r\n\t\t\tseries.disableDrawing();\r\n\t\t});\r\n\t\tthis._currentEnabledSeries = [];\r\n\r\n\t\t// Disable editing\r\n\t\tif (!tool) {\r\n\t\t\tif (isInited) {\r\n\t\t\t\tthis.getPrivate(\"eraserControl\")!.set(\"active\", false);\r\n\t\t\t}\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tstockChart.setPrivate(\"drawingSelectionEnabled\", false)\t\t\t\r\n\t\t\tstockChart.unselectDrawings();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check if we need to create series\r\n\t\tthis._maybeInitToolSeries(tool);\r\n\t\tlet seriesList = this._drawingSeries[tool];\r\n\r\n\t\tlet prevPanel: StockPanel;\r\n\t\t$array.each(seriesList, (series) => {\r\n\t\t\tif (prevPanel !== series.chart) {\r\n\t\t\t\tseries.enableDrawing();\r\n\t\t\t\tthis._currentEnabledSeries.push(series);\r\n\t\t\t\tprevPanel = series.chart as StockPanel;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (isInited) {\r\n\t\t\tthis.getPrivate(\"toolControl\")!.setTool(tool);\r\n\r\n\t\t\t// Show/hide needed drawing property controls\r\n\t\t\tconst controls: any = {\r\n\t\t\t\tstrokeControl: [\"Average\", \"Callout\", \"Doodle\", \"Ellipse\", \"Fibonacci Timezone\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Parallel Channel\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\t\tstrokeWidthControl: [\"Average\", \"Doodle\", \"Ellipse\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\", \"Parallel Channel\"],\r\n\t\t\t\tstrokeDasharrayControl: [\"Average\", \"Doodle\", \"Ellipse\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\t\textensionControl: [\"Average\", \"Line\", \"Regression\", \"Trend Line\"],\r\n\t\t\t\tfillControl: [\"Callout\", \"Ellipse\", \"Quadrant Line\", \"Rectangle\", \"Parallel Channel\", \"Polyfill\", \"Triangle\", \"Polyfill\", \"Triangle\", \"Arrows &amp; Icons\", \"Fibonacci Timezone\"],\r\n\r\n\t\t\t\tlabelFillControl: [\"Callout\", \"Label\"],\r\n\t\t\t\tlabelFontSizeControl: [\"Callout\", \"Label\"],\r\n\t\t\t\tlabelFontFamilyControl: [\"Callout\", \"Label\"],\r\n\t\t\t\tboldControl: [\"Callout\", \"Label\"],\r\n\t\t\t\titalicControl: [\"Callout\", \"Label\"],\r\n\r\n\t\t\t\ticonControl: [\"Arrows &amp; Icons\"],\r\n\t\t\t\tsnapControl: [\"Callout\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Parallel Channel\", \"Label\", \"Callout\", \"Horizontal Line\", \"Horizontal Ray\", \"Vertical Line\", \"Quadrant Line\", \"Rectangle\", \"Measure\", \"Fibonacci\"],\r\n\t\t\t}\r\n\r\n\t\t\t$object.each(controls, (control, tools) => {\r\n\t\t\t\tconst controlElement = (<any>this).getPrivate(control);\r\n\t\t\t\tif (tools.indexOf(tool) == -1) {\r\n\t\t\t\t\tcontrolElement.hide();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tcontrolElement.show();\r\n\t\t\t\t}\r\n\t\t\t\t//controlElement!.getPrivate(\"button\").style.display = tools.indexOf(tool) == -1 ? \"none\" : \"\";\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _maybeInitToolSeries(tool: DrawingTools): void {\r\n\t\tlet seriesList = this._drawingSeries[tool];\r\n\t\tif (!seriesList) {\r\n\t\t\tseriesList = [];\r\n\t\t}\r\n\r\n\t\t// Get panels that are already initialized\r\n\t\tconst initializedPanels: StockPanel[] = [];\r\n\t\t$array.each(seriesList, (series: DrawingSeries) => {\r\n\t\t\tinitializedPanels.push(series.chart as StockPanel);\r\n\t\t});\r\n\r\n\t\t// Get target series\r\n\t\tconst chartSeries: XYSeries[] = this.get(\"series\", []);\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t// if (chartSeries.length == 0) {\r\n\t\t// \t// No target series set, take first series out of each chart\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tif (initializedPanels.indexOf(panel) == -1) {\r\n\t\t\t\tconst targetSeries = this._getPanelMainSeries(panel);\r\n\t\t\t\tif (targetSeries) {\r\n\t\t\t\t\tchartSeries.push(targetSeries);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t// }\r\n\r\n\t\tif (chartSeries.length > 0) {\r\n\t\t\tconst toolSettings: any = this.get(\"toolSettings\", {});\r\n\r\n\t\t\t// Populate the list\r\n\t\t\t$array.each(chartSeries, (chartSeries) => {\r\n\t\t\t\tlet series: DrawingSeries | undefined;\r\n\t\t\t\tconst xAxis = <any>chartSeries.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = <any>chartSeries.get(\"yAxis\");\r\n\t\t\t\tconst panel = chartSeries.chart! as StockPanel;\r\n\t\t\t\tlet template: any;\r\n\t\t\t\tif (toolSettings[tool]) {\r\n\t\t\t\t\ttemplate = Template.new(toolSettings[tool]);\r\n\t\t\t\t\tconst toolTemplates: any = this.getPrivate(\"toolTemplates\", {});\r\n\t\t\t\t\ttoolTemplates[tool] = template;\r\n\t\t\t\t\tthis.setPrivate(\"toolTemplates\", toolTemplates);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch (tool) {\r\n\t\t\t\t\tcase \"Arrows &amp; Icons\":\r\n\t\t\t\t\t\tconst icon = this.get(\"drawingIcon\", this.get(\"drawingIcons\")![0]);\r\n\t\t\t\t\t\tseries = IconSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\ticonSvgPath: icon.svgPath,\r\n\t\t\t\t\t\t\ticonScale: icon.scale,\r\n\t\t\t\t\t\t\ticonCenterX: icon.centerX,\r\n\t\t\t\t\t\t\ticonCenterY: icon.centerY,\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Average\":\r\n\t\t\t\t\t\tseries = AverageSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Callout\":\r\n\t\t\t\t\t\tseries = CalloutSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Doodle\":\r\n\t\t\t\t\t\tseries = DoodleSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Ellipse\":\r\n\t\t\t\t\t\tseries = EllipseSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Fibonacci\":\r\n\t\t\t\t\t\tseries = FibonacciSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Fibonacci Timezone\":\r\n\t\t\t\t\t\tseries = FibonacciTimezoneSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase \"Horizontal Line\":\r\n\t\t\t\t\t\tseries = HorizontalLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Horizontal Ray\":\r\n\t\t\t\t\t\tseries = HorizontalRaySeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Label\":\r\n\t\t\t\t\t\tseries = LabelSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Line\":\r\n\t\t\t\t\t\tseries = SimpleLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Line Arrow\":\r\n\t\t\t\t\t\tseries = LineArrowSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Measure\":\r\n\t\t\t\t\t\tseries = Measure.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Parallel Channel\":\r\n\t\t\t\t\t\tseries = ParallelChannelSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Polyline\":\r\n\t\t\t\t\t\tseries = PolylineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Polyfill\":\r\n\t\t\t\t\t\tseries = PolylineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfillShape: true\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Triangle\":\r\n\t\t\t\t\t\tseries = PolylineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfillShape: true,\r\n\t\t\t\t\t\t\tpointCount: 3\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Quadrant Line\":\r\n\t\t\t\t\t\tseries = QuadrantLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rectangle\":\r\n\t\t\t\t\t\tseries = RectangleSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Regression\":\r\n\t\t\t\t\t\tseries = RegressionSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Trend Line\":\r\n\t\t\t\t\t\tseries = TrendLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Vertical Line\":\r\n\t\t\t\t\t\tseries = VerticalLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif (series) {\r\n\t\t\t\t\tseriesList.push(series);\r\n\t\t\t\t\tpanel.drawings.push(series);\r\n\t\t\t\t\tseries.setPrivate(\"baseValueSeries\", chartSeries);\r\n\t\t\t\t\tseries.set(\"valueYShow\", stockChart.getSeriesDefault(chartSeries, \"valueYShow\"));\r\n\t\t\t\t\tseries.set(\"calculateAggregates\", true);\r\n\t\t\t\t\tif (stockChart.getPrivate(\"comparing\")) {\r\n\t\t\t\t\t\tstockChart.setPercentScale(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis._drawingSeries[tool] = seriesList;\r\n\r\n\t\t\tthis._setStroke();\r\n\t\t\tthis._setFill();\r\n\t\t\tthis._setLabel();\r\n\t\t\tthis._setDrawingIcon();\r\n\t\t\tthis._setSnap();\r\n\t\t\tthis._setExtension();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSeriesBindings(panel: StockPanel): void {\r\n\t\tconst targetSeries = this._getPanelMainSeries(panel);\r\n\t\tif (targetSeries) {\r\n\t\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t\t$array.eachReverse(seriesList, (series) => {\r\n\t\t\t\t\tif (series.chart == panel) {\r\n\t\t\t\t\t\tif (panel.isDisposed()) {\r\n\t\t\t\t\t\t\t$array.remove(seriesList, series);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tseries.set(\"series\", targetSeries);\r\n\t\t\t\t\t\t\tseries.setPrivate(\"baseValueSeries\", targetSeries);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getPanelMainSeries(panel: StockPanel): XYSeries | undefined {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tlet targetSeries: XYSeries | undefined;\r\n\t\tif (stockSeries && stockSeries.chart == panel) {\r\n\t\t\ttargetSeries = stockSeries;\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttargetSeries = panel.series.getIndex(0);\r\n\t\t}\r\n\t\treturn targetSeries;\r\n\t}\r\n\r\n\tprotected _updatePanelBindings(): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tpanel.series.events.onAll(() => this._updateSeriesBindings(panel));\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _setStroke(): void {\r\n\t\tconst strokeDasharray = JSON.stringify(this.get(\"strokeDasharray\"));\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tseries.setAll({\r\n\t\t\t\t\tstrokeColor: this.get(\"strokeColor\"),\r\n\t\t\t\t\tstrokeWidth: this.get(\"strokeWidth\"),\r\n\t\t\t\t\tstrokeOpacity: this.get(\"strokeOpacity\")\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (JSON.stringify(series.get(\"strokeDasharray\")) !== strokeDasharray) {\r\n\t\t\t\t\tseries.set(\"strokeDasharray\", this.get(\"strokeDasharray\"));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setFill(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tseries.setAll({\r\n\t\t\t\t\tfillColor: this.get(\"fillColor\"),\r\n\t\t\t\t\tfillOpacity: this.get(\"fillOpacity\")\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setLabel(): void {\r\n\t\tconst labelTools = [\"Callout\", \"Label\"];\r\n\t\t$object.each(this._drawingSeries, (tool, seriesList) => {\r\n\t\t\tif (labelTools.indexOf(<string>tool) != -1) {\r\n\t\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\t\t(<LabelSeries>series).setAll({\r\n\t\t\t\t\t\tlabelFill: this.get(\"labelFill\"),\r\n\t\t\t\t\t\tlabelFontSize: this.get(\"labelFontSize\"),\r\n\t\t\t\t\t\tlabelFontFamily: this.get(\"labelFontFamily\"),\r\n\t\t\t\t\t\tlabelFontWeight: this.get(\"labelFontWeight\"),\r\n\t\t\t\t\t\tlabelFontStyle: this.get(\"labelFontStyle\")\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setExtension(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series instanceof SimpleLineSeries) {\r\n\t\t\t\t\tseries.setAll({\r\n\t\t\t\t\t\tshowExtension: this.get(\"showExtension\")\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setDrawingIcon(): void {\r\n\t\tif (!this._isInited()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst icon = this.get(\"drawingIcon\", this.get(\"drawingIcons\")![0]);\r\n\t\tconst fillControl = this.getPrivate(\"fillControl\")!;\r\n\t\tif (icon.fillDisabled) {\r\n\t\t\tfillControl.hide();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfillControl.show();\r\n\t\t}\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series instanceof IconSeries) {\r\n\t\t\t\t\tseries.setAll({\r\n\t\t\t\t\t\ticonSvgPath: icon.svgPath,\r\n\t\t\t\t\t\ticonScale: icon.scale,\r\n\t\t\t\t\t\ticonCenterX: icon.centerX,\r\n\t\t\t\t\t\ticonCenterY: icon.centerY,\r\n\t\t\t\t\t\tfillOpacity: icon.fillDisabled ? 0 : this.get(\"fillOpacity\")\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setSnap(): void {\r\n\t\tconst snap = this.get(\"snapToData\", false);\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series.getPrivate(\"allowChangeSnap\")) {\r\n\t\t\t\t\tseries.set(\"snapToData\", snap);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Draw\");\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t\tconst toolsContainer = this.getPrivate(\"toolsContainer\");\r\n\t\tif (toolsContainer) {\r\n\t\t\t$utils.removeElement(toolsContainer);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getSeriesTool(series: DrawingSeries): DrawingTools | undefined {\r\n\t\tif (series instanceof DrawingSeries) {\r\n\t\t\tlet name = series.className;\r\n\t\t\tif (name == \"SimpleLineSeries\") {\r\n\t\t\t\treturn \"Line\";\r\n\t\t\t}\r\n\t\t\telse if (name == \"IconSeries\") {\r\n\t\t\t\treturn \"Arrows &amp; Icons\";\r\n\t\t\t}\r\n\t\t\telse if (name == \"PolylineSeries\" && (series as PolylineSeries).get(\"pointCount\") == 3) {\r\n\t\t\t\treturn \"Triangle\";\r\n\t\t\t}\r\n\t\t\telse if (name == \"PolylineSeries\" && (series as PolylineSeries).get(\"fillShape\")) {\r\n\t\t\t\treturn \"Polyfill\";\r\n\t\t\t}\r\n\t\t\tname = $utils.addSpacing(name.replace(\"Series\", \"\"));\r\n\t\t\treturn name as DrawingTools;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Serializes all drawings into an array of simple objects or JSON.\r\n\t *\r\n\t * `output` parameter can either be `\"object\"` or `\"string\"` (default).\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/serializing-indicators-annotations/} for more info\r\n\t * @since 5.3.0\r\n\t * @param   output Output format\r\n\t * @param   indent Line indent in JSON\r\n\t * @return         Serialized indicators\r\n\t */\r\n\tpublic serializeDrawings(output: \"object\" | \"string\" = \"string\", indent?: string): Array<unknown> | string {\r\n\t\tconst res: Array<any> = [];\r\n\t\tthis.get(\"stockChart\").panels.each((panel, panelIndex) => {\r\n\t\t\tpanel.series.each((series) => {\r\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\r\n\t\t\t\t\tconst serializer = Serializer.new(this.root, {\r\n\t\t\t\t\t\tincludeSettings: [\"strokeColor\", \"fillColor\", \"strokeOpacity\", \"fillOpacity\", \"strokeWidth\", \"strokeDasharray\", \"field\", \"snapToData\", \"svgPath\", \"labelFontSize\", \"labelFontFamily\", \"labelFontWeight\", \"labelFontStyle\", \"labelFill\", \"showExtension\"],\r\n\t\t\t\t\t\t//includeSettings: [\"data\"],\r\n\t\t\t\t\t\tmaxDepth: 4\r\n\t\t\t\t\t});\r\n\t\t\t\t\tseries.data.values.map((row: any) => {\r\n\t\t\t\t\t\trow.__parse = true;\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconst json: any = {\r\n\t\t\t\t\t\t__tool: this._getSeriesTool(series),\r\n\t\t\t\t\t\t__panelIndex: panelIndex,\r\n\t\t\t\t\t\t__drawing: serializer.serialize(series.data.values, 0, true)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//json.__panelIndex = panelIndex;\r\n\t\t\t\t\tres.push(json);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn output == \"object\" ? res : JSON.stringify(res, undefined, indent);\r\n\t}\r\n\r\n\t/**\r\n\t * Parses data serialized with `serializeDrawings()` and adds drawings to the\r\n\t * chart.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/serializing-indicators-annotations/} for more info\r\n\t * @since 5.3.0\r\n\t * @param  data Serialized data\r\n\t */\r\n\tpublic unserializeDrawings(data: string | Array<any>): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tif ($type.isString(data)) {\r\n\t\t\tdata = JSON.parse(data);\r\n\t\t}\r\n\t\tif (!$type.isArray(data)) {\r\n\t\t\tdata = [data];\r\n\t\t}\r\n\t\t$array.each(data, (drawing) => {\r\n\t\t\t// Panel\r\n\t\t\tlet panel = stockChart.panels.getIndex(drawing.__panelIndex || 0)!;\r\n\r\n\t\t\tif (panel) {\r\n\t\t\t\tconst tool = drawing.__tool;\r\n\r\n\t\t\t\tthis._maybeInitToolSeries(tool);\r\n\r\n\t\t\t\t// Get series\r\n\t\t\t\tlet drawingSeries: DrawingSeries;\r\n\t\t\t\t$array.each(this._drawingSeries[tool] || [], (series) => {\r\n\t\t\t\t\tif (series.chart === panel) {\r\n\t\t\t\t\t\tdrawingSeries = series;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!drawing.settings) {\r\n\t\t\t\t\tdrawing.settings = {};\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Parse\r\n\t\t\t\tJsonParser.new(this._root).parse(drawing.__drawing).then((drawingData: any) => {\r\n\t\t\t\t\tthis._updateDrawingIndexes(drawingData, drawingSeries._index, drawingSeries);\r\n\t\t\t\t\tdrawingSeries.data.pushAll(drawingData);\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Wait until panel becomes available\r\n\t\t\t\tstockChart.panels.events.once(\"push\", (ev) => {\r\n\t\t\t\t\tev.newValue.series.events.once(\"push\", (_ev) => {\r\n\t\t\t\t\t\tthis.unserializeDrawings(drawing);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _updateDrawingIndexes(drawingData: any, index: number, drawingSeries: DrawingSeries): void {\r\n\t\tif ($type.isArray(drawingData)) {\r\n\t\t\t$array.each(drawingData, (item: any) => {\r\n\t\t\t\tthis._updateDrawingIndexes(item, index, drawingSeries);\r\n\t\t\t})\r\n\t\t}\r\n\t\telse if ($type.isObject(drawingData as any) && drawingData.index !== undefined) {\r\n\t\t\tdrawingData.index += index;\r\n\t\t\tdrawingSeries._index = drawingData.index;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an object that holds all drawing series, arrange by tool (key).\r\n\t *\r\n\t * @since 5.8.0\r\n\t * @readonly\r\n\t */\r\n\tpublic get drawingSeries(): { [index: string]: DrawingSeries[] } {\r\n\t\treturn this._drawingSeries;\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a line drawing.\r\n\t *\r\n\t * Supported tools: `\"Horizontal Line\"`, `\"Horizontal Ray\"`, `\"Vertical Line\"`.\r\n\t * \r\n\t * @param  tool   Drawing tool\r\n\t * @param  panel  Panel\r\n\t * @param  point  Point\r\n\t * @since 5.10.2\r\n\t */\r\n\tpublic addLine(tool: \"Horizontal Line\" | \"Horizontal Ray\" | \"Vertical Line\", panel: StockPanel, point: IPoint): void {\r\n\t\tthis._maybeInitToolSeries(tool);\r\n\t\tconst seriesList = this._drawingSeries[tool];\r\n\t\tlet targetSeries: SimpleLineSeries | undefined;\r\n\t\t$array.each(seriesList, (series) => {\r\n\t\t\tif (panel === series.chart) {\r\n\t\t\t\ttargetSeries = series as SimpleLineSeries;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (targetSeries) {\r\n\t\t\ttargetSeries.addLine(point);\r\n\t\t}\r\n\t}\r\n}"]}